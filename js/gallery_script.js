const folderData = {
  "": [
    { name: "Conferences", type: "folder" },
    { name: "Field Trips", type: "folder" },
    { name: "Places", type: "folder" },
  ],
  "Field Trips": [
    { name: "Date(1)_place", type: "folder" },
    { name: "Date(2)_place", type: "folder" },
    { name: "Date(3)_place", type: "folder" },
  ],
  Conferences: [
    { name: "IGARSS_Australia_2025", type: "folder" },
    { name: "IGARSS_USA_2023", type: "folder" },
    { name: "InGARSS_Goa_2024", type: "folder" },
    { name: "MIGARSS_Hyderabad_2023", type: "folder" },
  ],
  Places: [
    { name: "Agra", type: "folder" },
    { name: "Bengaluru", type: "folder" },
    { name: "Bhopal", type: "folder" },
    { name: "Delhi", type: "folder" },
    { name: "Goa", type: "folder" },
    { name: "Gwalior", type: "folder" },
    { name: "Hampi", type: "folder" },
    { name: "Hogenakkal", type: "folder" },
    { name: "Indore", type: "folder" },
    { name: "Jhansi", type: "folder" },
    { name: "Kanyakumari", type: "folder" },
    { name: "Kedarnath", type: "folder" },
    { name: "Kernal", type: "folder" },
    { name: "Kolar", type: "folder" },
    { name: "Lepakshi", type: "folder" },
    { name: "Lucknow", type: "folder" },
    { name: "Madurai", type: "folder" },
    { name: "Nainital", type: "folder" },
    { name: "Nandi Hills", type: "folder" },
    { name: "Nepal", type: "folder" },
    { name: "Orchha", type: "folder" },
    { name: "Rameshwaram", type: "folder" },
    { name: "Sultanpur", type: "folder" },
    { name: "Thiruvananthapuram", type: "folder" },
    { name: "Varanasi", type: "folder" },
  ],
  "Field Trips/Date(1)_place": [
    { name: "1.jpg", type: "photo" },
    { name: "2.jpg", type: "photo" },
  ],
  "Field Trips/Date(2)_place": [
    { name: "1.jpg", type: "photo" },
    { name: "2.jpg", type: "photo" },
  ],
  "Conferences/IGARSS_Australia_2025": [
    { name: "1.jpg", type: "photo" },
    { name: "2.jpg", type: "photo" },
  ],
  "Conferences/IGARSS_USA_2023": [
    { name: "1.jpg", type: "photo" },
    { name: "2.jpg", type: "photo" },
  ],
  "Conferences/InGARSS_Goa_2024": [
    { name: "1.jpg", type: "photo" },
    { name: "2.jpg", type: "photo" },
  ],
  "Conferences/MIGARSS_Hyderabad_2023": [
    { name: "1.jpg", type: "photo" },
    { name: "2.jpg", type: "photo" },
  ],
  "Places/Agra": [
    { name: "1.jpg", type: "photo" },
    { name: "2.jpg", type: "photo" },
  ],
  "Places/Bengaluru": [
    { name: "1.jpg", type: "photo" },
    { name: "2.jpg", type: "photo" },
  ],
  "Places/Bhopal": [
    { name: "1.jpg", type: "photo" },
    { name: "2.jpg", type: "photo" },
  ],
  "Places/Delhi": [
    { name: "1.jpg", type: "photo" },
    { name: "2.jpg", type: "photo" },
  ],
  "Places/Goa": [
    { name: "1.jpg", type: "photo" },
    { name: "2.jpg", type: "photo" },
  ],
  "Places/Gwalior": [
    { name: "1.jpg", type: "photo" },
    { name: "2.jpg", type: "photo" },
  ],
  "Places/Hampi": [
    { name: "1.jpg", type: "photo" },
    { name: "2.jpg", type: "photo" },
  ],
  "Places/Hogenakkal": [
    { name: "1.jpg", type: "photo" },
    { name: "2.jpg", type: "photo" },
    { name: "3.jpg", type: "photo" },
    { name: "4.jpg", type: "photo" },
    { name: "5.jpg", type: "photo" },
    { name: "6.jpg", type: "photo" },
    { name: "7.jpg", type: "photo" },
    { name: "8.jpg", type: "photo" },
    { name: "9.jpg", type: "photo" },
    { name: "10.jpg", type: "photo" },
  ],
  "Places/Indore": [
    { name: "1.jpg", type: "photo" },
    { name: "2.jpg", type: "photo" },
  ],
  "Places/Jhansi": [
    { name: "1.jpg", type: "photo" },
    { name: "2.jpg", type: "photo" },
    { name: "3.jpg", type: "photo" },
    { name: "4.jpg", type: "photo" },
  ],
  "Places/Kanyakumari": [
    { name: "1.jpg", type: "photo" },
    { name: "2.jpg", type: "photo" },
  ],
  "Places/Kedarnath": [
    { name: "1.jpg", type: "photo" },
    { name: "2.jpg", type: "photo" },
    { name: "3.jpg", type: "photo" },
    { name: "4.jpg", type: "photo" },
    { name: "5.jpg", type: "photo" },
    { name: "6.jpg", type: "photo" },
    { name: "7.jpg", type: "photo" },
  ],
  "Places/Kernal": [
    { name: "1.jpg", type: "photo" },
    { name: "2.jpg", type: "photo" },
  ],
  "Places/Kolar": [
    { name: "1.jpg", type: "photo" },
    { name: "2.jpg", type: "photo" },
  ],
  "Places/Lepakshi": [
    { name: "1.jpg", type: "photo" },
    { name: "2.jpg", type: "photo" },
  ],
  "Places/Lucknow": [
    { name: "1.jpg", type: "photo" },
    { name: "2.jpg", type: "photo" },
    { name: "3.jpg", type: "photo" },
  ],
  "Places/Madurai": [
    { name: "1.jpg", type: "photo" },
    { name: "2.jpg", type: "photo" },
  ],
  "Places/Nainital": [
    { name: "1.jpg", type: "photo" },
    { name: "2.jpg", type: "photo" },
    { name: "3.jpg", type: "photo" },
    { name: "4.jpg", type: "photo" },
    { name: "5.jpg", type: "photo" },
    { name: "6.jpg", type: "photo" },
    { name: "7.jpg", type: "photo" },
    { name: "8.jpg", type: "photo" },
    { name: "9.jpg", type: "photo" },
    { name: "10.jpg", type: "photo" },
    { name: "11.jpg", type: "photo" },
    { name: "12.jpg", type: "photo" },
    { name: "13.jpg", type: "photo" },
  ],
  "Places/Nandi Hills": [
    { name: "1.jpg", type: "photo" },
    { name: "2.jpg", type: "photo" },
    { name: "3.jpg", type: "photo" },
    { name: "4.jpg", type: "photo" },
    { name: "5.jpg", type: "photo" },
    { name: "6.jpg", type: "photo" },
    { name: "7.jpg", type: "photo" },
  ],
  "Places/Nepal": [
    { name: "1.jpg", type: "photo" },
    { name: "2.jpg", type: "photo" },
  ],
  "Places/Orchha": [
    { name: "1.jpg", type: "photo" },
    { name: "2.jpg", type: "photo" },
    { name: "3.jpg", type: "photo" },
    { name: "4.jpg", type: "photo" },
  ],
  "Places/Rameshwaram": [
    { name: "1.jpg", type: "photo" },
    { name: "2.jpg", type: "photo" },
    { name: "3.jpg", type: "photo" },
  ],
  "Places/Sultanpur": [
    { name: "1.jpg", type: "photo" },
    { name: "2.jpg", type: "photo" },
    { name: "3.jpg", type: "photo" },
  ],
  "Places/Thiruvananthapuram": [
    { name: "1.jpg", type: "photo" },
    { name: "2.jpg", type: "photo" },
  ],
  "Places/Varanasi": [
    { name: "1.jpg", type: "photo" },
    { name: "2.jpg", type: "photo" },
  ],
};

let currentPath = ""; // Keeps track of the current path
let folderHistory = []; // To keep track of folder navigation

function renderContent(path, containerId) {
  const container = document.getElementById(containerId);
  container.innerHTML = ""; // Clear existing content

  const items = folderData[path] || [];
  items.forEach((item) => {
    const itemElement = document.createElement("div");
    itemElement.classList.add(
      item.type === "folder" ? "folder-item" : "photo-item"
    );

    if (item.type === "folder") {
      const folderIcon = document.createElement("img");
      folderIcon.src = "images/icons/folder-icon.png"; // Path to the folder icon
      folderIcon.alt = `${item.name} Icon`;
      folderIcon.classList.add("folder-icon"); // Add a class for styling
      folderIcon.onerror = () => {
        folderIcon.src = "images/icons/default-folder-icon.png"; // Fallback folder icon
      };

      const folderName = document.createElement("p");
      folderName.textContent = item.name;

      itemElement.appendChild(folderIcon);
      itemElement.appendChild(folderName);

      itemElement.addEventListener("click", () => {
        folderHistory.push(currentPath); // Save current path
        currentPath = path ? `${path}/${item.name}` : item.name; // Dynamically construct the path
        renderContent(currentPath, containerId);
        document.getElementById("back-button").style.display = "block"; // Show back button
        document.getElementById("home-button").style.display = "none"; // Hide home button
      });
    } else if (item.type === "photo") {
      const photo = document.createElement("img");
      photo.src = `gallery/${path}/${item.name}`; // Dynamically construct the photo path
      photo.alt = item.name;
      photo.classList.add("photo");
      photo.onerror = () => {
        photo.src = "images/icons/default-photo.png"; // Fallback photo
      };

      itemElement.appendChild(photo);
    }

    container.appendChild(itemElement);
  });

  // Initialize the lightbox functionality for the newly added images
  initializeLightbox();
}

// Back button functionality
function goBack() {
  if (folderHistory.length > 0) {
    currentPath = folderHistory.pop(); // Get the previous path
    renderContent(currentPath, "folder-container");

    if (folderHistory.length === 0) {
      document.getElementById("back-button").style.display = "none"; // Hide back button if at root
      document.getElementById("home-button").style.display = "block"; // Show home button
    }
  }
}

// Add event listener for the back button
document.getElementById("back-button").addEventListener("click", goBack);

// Add event listener for the keyboard backspace key
document.addEventListener("keydown", (event) => {
  if (event.key === "Backspace") {
    event.preventDefault(); // Prevent default browser back navigation
    goBack();
  }
});

// Function to initialize the lightbox functionality
function initializeLightbox() {
  // Create the lightbox container
  const lightbox = document.createElement("div");
  lightbox.classList.add("lightbox");

  // Add an image element to the lightbox
  const lightboxImage = document.createElement("img");
  lightbox.appendChild(lightboxImage);

  // Add a close button to the lightbox
  const closeButton = document.createElement("button");
  closeButton.classList.add("close");
  closeButton.innerHTML = "&times;"; // Close icon
  lightbox.appendChild(closeButton);

  // Add left and right navigation arrows
  const leftArrow = document.createElement("button");
  leftArrow.classList.add("arrow", "left-arrow");
  leftArrow.innerHTML = "&#10094;"; // Left arrow symbol
  lightbox.appendChild(leftArrow);

  const rightArrow = document.createElement("button");
  rightArrow.classList.add("arrow", "right-arrow");
  rightArrow.innerHTML = "&#10095;"; // Right arrow symbol
  lightbox.appendChild(rightArrow);

  // Append the lightbox to the body
  document.body.appendChild(lightbox);

  // Track the currently displayed image and all images
  let currentImageIndex = -1;
  let images = [];

  // Function to update the lightbox image
  function updateLightboxImage(index) {
    if (index >= 0 && index < images.length) {
      currentImageIndex = index;
      lightboxImage.src = images[currentImageIndex].src;
      lightbox.style.display = "flex"; // Show the lightbox
    }
  }

  // Add event listener to close the lightbox
  closeButton.addEventListener("click", () => {
    lightbox.style.display = "none";
  });

  // Add event listener to close the lightbox when clicking outside the image
  lightbox.addEventListener("click", (event) => {
    if (event.target === lightbox) {
      lightbox.style.display = "none";
    }
  });

  // Add event listeners for navigation arrows
  leftArrow.addEventListener("click", () => {
    updateLightboxImage(
      (currentImageIndex - 1 + images.length) % images.length
    );
  });

  rightArrow.addEventListener("click", () => {
    updateLightboxImage((currentImageIndex + 1) % images.length);
  });

  // Add keyboard navigation for lightbox
  document.addEventListener("keydown", (event) => {
    if (lightbox.style.display === "flex") {
      if (event.key === "ArrowRight") {
        // Show the next image
        updateLightboxImage((currentImageIndex + 1) % images.length);
      } else if (event.key === "ArrowLeft") {
        // Show the previous image
        updateLightboxImage(
          (currentImageIndex - 1 + images.length) % images.length
        );
      } else if (event.key === "Escape") {
        // Close the lightbox
        lightbox.style.display = "none";
      }
    }
  });

  // Add click event to all images
  images = document.querySelectorAll(".photo-item img");
  images.forEach((image, index) => {
    image.addEventListener("click", () => {
      updateLightboxImage(index); // Open the clicked image in the lightbox
    });
  });
}

// Enable keyboard navigation for the photo and folder grid
function enableKeyboardNavigation(containerId) {
  const container = document.getElementById(containerId);
  const items = Array.from(
    container.querySelectorAll(".folder-item, .photo-item")
  ); // Get all folder and photo items
  let currentIndex = 0; // Track the currently focused item

  // Function to update focus on the current item
  function updateFocus(index) {
    if (items[currentIndex]) {
      items[currentIndex].classList.remove("focused"); // Remove focus from the previous item
    }
    currentIndex = index;
    if (items[currentIndex]) {
      items[currentIndex].classList.add("focused"); // Add focus to the current item
      items[currentIndex].scrollIntoView({
        behavior: "smooth",
        block: "center",
      }); // Scroll into view
    }
  }

  // Add keyboard event listener
  container.addEventListener("keydown", (event) => {
    const columns = Math.floor(container.offsetWidth / items[0].offsetWidth); // Calculate the number of columns
    if (event.key === "ArrowRight") {
      // Move to the next item
      updateFocus((currentIndex + 1) % items.length);
      event.preventDefault(); // Prevent default scrolling
    } else if (event.key === "ArrowLeft") {
      // Move to the previous item
      updateFocus((currentIndex - 1 + items.length) % items.length);
      event.preventDefault(); // Prevent default scrolling
    } else if (event.key === "ArrowDown") {
      // Move down in the grid
      updateFocus((currentIndex + columns) % items.length);
      event.preventDefault(); // Prevent default scrolling
    } else if (event.key === "ArrowUp") {
      // Move up in the grid
      updateFocus((currentIndex - columns + items.length) % items.length);
      event.preventDefault(); // Prevent default scrolling
    } else if (event.key === "Enter") {
      // Trigger click on the focused item
      items[currentIndex].click();
    }
  });

  // Initialize focus on the first item
  if (items.length > 0) {
    items[0].setAttribute("tabindex", "0"); // Make the first item focusable
    items[0].focus(); // Set focus to the first item
    updateFocus(0); // Highlight the first item
  }
}

// Enable touch navigation for the photo and folder grid
function enableTouchNavigation(containerId) {
  const container = document.getElementById(containerId);
  let startX = 0;

  // Add touchstart event listener
  container.addEventListener("touchstart", (event) => {
    if (event.touches.length === 1) {
      startX = event.touches[0].clientX; // Record the starting touch position
    }
  });

  // Add touchend event listener
  container.addEventListener("touchend", (event) => {
    if (event.changedTouches.length === 1) {
      const endX = event.changedTouches[0].clientX; // Record the ending touch position
      const deltaX = endX - startX;

      if (Math.abs(deltaX) > 50) {
        // Swipe threshold
        if (deltaX > 0) {
          // Swipe right
          container.dispatchEvent(
            new KeyboardEvent("keydown", { key: "ArrowLeft" })
          );
        } else {
          // Swipe left
          container.dispatchEvent(
            new KeyboardEvent("keydown", { key: "ArrowRight" })
          );
        }
      }
    }
  });
}

// Initialize the lightbox functionality after the DOM is loaded
document.addEventListener("DOMContentLoaded", initializeLightbox);

// Initialize the gallery and enable keyboard navigation
document.addEventListener("DOMContentLoaded", () => {
  renderContent("", "folder-container");
  enableKeyboardNavigation("folder-container");
  enableKeyboardNavigation("photo-container"); // Enable navigation for the photo grid
});

// Initialize touch navigation for folder and photo grids
document.addEventListener("DOMContentLoaded", () => {
  enableTouchNavigation("folder-container");
  enableTouchNavigation("photo-container");
});

// Initialize the gallery and render the root folder
document.addEventListener("DOMContentLoaded", () => {
  renderContent("", "folder-container");
});
